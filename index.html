<body>
  <div class="container">
    <h1>Spreadsheet Transformer</h1>

    <div class="button-row">
      <button onclick="toggleInstructions()">Instructions</button>
      <button onclick="toggleFixedDataRange()">My Fixed Data Range / Columns</button>
      <button onclick="toggleTripletDataRange()">Triplet Data Range</button>
    </div>

    <!-- Instructions Panel -->
    <div id="instructions" style="display:none;">
      <h3>Instructions</h3>
      <ol>
        <li>Click <strong>Upload</strong> to choose an Excel or CSV file.</li>
        <li>Click <strong>My Fixed Data Range / Columns</strong> to specify columns that should remain unchanged.</li>
        <li>Click <strong>Triplet Data Range</strong> to specify columns for Brand, Subcategory, and SKU data.</li>
        <li>Click <strong>Process</strong> to normalize the data.</li>
        <li>Click <strong>Download Excel</strong> to export the result.</li>
      </ol>
    </div>

    <!-- Fixed Data Range Panel -->
    <div id="fixedDataRange" style="display:none;">
      <h3>My Fixed Data Range / Columns</h3>
      <p>Select the columns that should remain fixed in your data:</p>
      <input type="text" id="fixedColumns" placeholder="Enter fixed columns (e.g., A, B, C)" />
      <button onclick="applyFixedColumns()">Apply</button>
    </div>

    <!-- Triplet Data Range Panel -->
    <div id="tripletDataRange" style="display:none;">
      <h3>Triplet Data Range</h3>
      <p>Select the columns that contain Brand, Sub Category, and SKU:</p>
      <input type="text" id="tripletColumns" placeholder="Enter triplet columns (e.g., D:F, G:I)" />
      <button onclick="applyTripletColumns()">Apply</button>
    </div>

    <input type="file" id="upload" accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" />
    <button id="processBtn" disabled>Process</button>
    <button id="downloadBtn" disabled>Download Excel</button>
    <p id="status"></p>
    <table id="preview"></table>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="script.js"></script>
  <script>
    // Toggle Instructions Panel
    function toggleInstructions() {
      const instr = document.getElementById("instructions");
      instr.style.display = instr.style.display === "none" ? "block" : "none";
    }

    // Toggle Fixed Data Range Panel
    function toggleFixedDataRange() {
      const fixedRange = document.getElementById("fixedDataRange");
      fixedRange.style.display = fixedRange.style.display === "none" ? "block" : "none";
    }

    // Toggle Triplet Data Range Panel
    function toggleTripletDataRange() {
      const tripletRange = document.getElementById("tripletDataRange");
      tripletRange.style.display = tripletRange.style.display === "none" ? "block" : "none";
    }

    // Apply Fixed Data Range (capturing user input)
    function applyFixedColumns() {
      const fixedCols = document.getElementById("fixedColumns").value;
      console.log("Fixed columns applied: " + fixedCols);
      // You can add logic here to store and apply these ranges to the data
    }

    // Apply Triplet Data Range (capturing user input)
    function applyTripletColumns() {
      const tripletCols = document.getElementById("tripletColumns").value;
      console.log("Triplet columns applied: " + tripletCols);
      // You can add logic here to store and apply these ranges to the data
    }
  </script>
</body>
